<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ADCとサポート検索</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Tabletop.js/1.5.3/tabletop.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, button { font-size: 1rem; padding: 5px; margin: 5px 0; }
    #result { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>ADCと相性のいいサポート検索</h1>
  <input type="text" id="adcInput" placeholder="例: Jhin">
  <button onclick="searchSupport()">検索</button>

  <div id="result">データを読み込み中...</div>

  <script>
    let supportData = {};

    // あなたのスプレッドシートIDに置き換えてください
    const publicSpreadsheetURL = 'https://docs.google.com/spreadsheets/d/10Ze9dnkLwe8EOBk7dpojiGZrgtMK_t5knEnEq3rscNM/edit?gid=0#gid=0';
    
    function init() {
      Tabletop.init({
        key: publicSpreadsheetURL,
        simpleSheet: true,
        callback: function(data) {
          data.forEach(row => {
            const adc = row['ADC'].trim().toLowerCase();
            const supports = row['Supports'].split(',').map(s => s.trim());
            supportData[adc] = supports;
          });
          document.getElementById("result").innerText = '準備完了！ADC名を入力してください。';
        }
      });
    }

    function normalize(input) {
    return input.trim(); // 日本語では小文字変換などは不要
    }


    function searchSupport() {
      const input = document.getElementById("adcInput").value.trim();
      const normalized = normalize(input);
      const resultDiv = document.getElementById("result");

      if (supportData[normalized]) {
        resultDiv.innerHTML = `相性のいいサポート: ${supportData[normalized].join(', ')}`;
      } else {
        resultDiv.innerHTML = "そのADCのデータは見つかりませんでした。";
      }
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>

</body>
</html>
